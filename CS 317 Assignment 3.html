<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii"><script type="text/javascript">(window.NREUM||(NREUM={})).loader_config={xpid:"XA4GVl5ACwcBUVdaAA=="};window.NREUM||(NREUM={}),__nr_require=function(t,e,n){function r(n){if(!e[n]){var o=e[n]={exports:{}};t[n][0].call(o.exports,function(e){var o=t[n][1][e];return r(o||e)},o,o.exports)}return e[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<n.length;o++)r(n[o]);return r}({1:[function(t,e,n){function r(t){try{c.console&&console.log(t)}catch(e){}}var o,i=t("ee"),a=t(12),c={};try{o=localStorage.getItem("__nr_flags").split(","),console&&"function"==typeof console.log&&(c.console=!0,o.indexOf("dev")!==-1&&(c.dev=!0),o.indexOf("nr_dev")!==-1&&(c.nrDev=!0))}catch(s){}c.nrDev&&i.on("internal-error",function(t){r(t.stack)}),c.dev&&i.on("fn-err",function(t,e,n){r(n.stack)}),c.dev&&(r("NR AGENT IN DEVELOPMENT MODE"),r("flags: "+a(c,function(t,e){return t}).join(", ")))},{}],2:[function(t,e,n){function r(t,e,n,r,o){try{d?d-=1:i("err",[o||new UncaughtException(t,e,n)])}catch(c){try{i("ierr",[c,s.now(),!0])}catch(u){}}return"function"==typeof f&&f.apply(this,a(arguments))}function UncaughtException(t,e,n){this.message=t||"Uncaught error with no additional information",this.sourceURL=e,this.line=n}function o(t){i("err",[t,s.now()])}var i=t("handle"),a=t(13),c=t("ee"),s=t("loader"),f=window.onerror,u=!1,d=0;s.features.err=!0,t(1),window.onerror=r;try{throw new Error}catch(l){"stack"in l&&(t(5),t(4),"addEventListener"in window&&t(3),s.xhrWrappable&&t(6),u=!0)}c.on("fn-start",function(t,e,n){u&&(d+=1)}),c.on("fn-err",function(t,e,n){u&&(this.thrown=!0,o(n))}),c.on("fn-end",function(){u&&!this.thrown&&d>0&&(d-=1)}),c.on("internal-error",function(t){i("ierr",[t,s.now(),!0])})},{}],3:[function(t,e,n){function r(t){for(var e=t;e&&!e.hasOwnProperty(u);)e=Object.getPrototypeOf(e);e&&o(e)}function o(t){c.inPlace(t,[u,d],"-",i)}function i(t,e){return t[1]}var a=t("ee").get("events"),c=t(15)(a,!0),s=t("gos"),f=XMLHttpRequest,u="addEventListener",d="removeEventListener";e.exports=a,"getPrototypeOf"in Object?(r(document),r(window),r(f.prototype)):f.prototype.hasOwnProperty(u)&&(o(window),o(f.prototype)),a.on(u+"-start",function(t,e){var n=t[1],r=s(n,"nr@wrapped",function(){function t(){if("function"==typeof n.handleEvent)return n.handleEvent.apply(n,arguments)}var e={object:t,"function":n}[typeof n];return e?c(e,"fn-",null,e.name||"anonymous"):n});this.wrapped=t[1]=r}),a.on(d+"-start",function(t){t[1]=this.wrapped||t[1]})},{}],4:[function(t,e,n){var r=t("ee").get("raf"),o=t(15)(r),i="equestAnimationFrame";e.exports=r,o.inPlace(window,["r"+i,"mozR"+i,"webkitR"+i,"msR"+i],"raf-"),r.on("raf-start",function(t){t[0]=o(t[0],"fn-")})},{}],5:[function(t,e,n){function r(t,e,n){t[0]=a(t[0],"fn-",null,n)}function o(t,e,n){this.method=n,this.timerDuration=isNaN(t[1])?0:+t[1],t[0]=a(t[0],"fn-",this,n)}var i=t("ee").get("timer"),a=t(15)(i),c="setTimeout",s="setInterval",f="clearTimeout",u="-start",d="-";e.exports=i,a.inPlace(window,[c,"setImmediate"],c+d),a.inPlace(window,[s],s+d),a.inPlace(window,[f,"clearImmediate"],f+d),i.on(s+u,r),i.on(c+u,o)},{}],6:[function(t,e,n){function r(t,e){d.inPlace(e,["onreadystatechange"],"fn-",c)}function o(){var t=this,e=u.context(t);t.readyState>3&&!e.resolved&&(e.resolved=!0,u.emit("xhr-resolved",[],t)),d.inPlace(t,w,"fn-",c)}function i(t){g.push(t),h&&(b?b.then(a):v?v(a):(E=-E,O.data=E))}function a(){for(var t=0;t<g.length;t++)r([],g[t]);g.length&&(g=[])}function c(t,e){return e}function s(t,e){for(var n in t)e[n]=t[n];return e}t(3);var f=t("ee"),u=f.get("xhr"),d=t(15)(u),l=NREUM.o,p=l.XHR,h=l.MO,m=l.PR,v=l.SI,y="readystatechange",w=["onload","onerror","onabort","onloadstart","onloadend","onprogress","ontimeout"],g=[];e.exports=u;var x=window.XMLHttpRequest=function(t){var e=new p(t);try{u.emit("new-xhr",[e],e),e.addEventListener(y,o,!1)}catch(n){try{u.emit("internal-error",[n])}catch(r){}}return e};if(s(p,x),x.prototype=p.prototype,d.inPlace(x.prototype,["open","send"],"-xhr-",c),u.on("send-xhr-start",function(t,e){r(t,e),i(e)}),u.on("open-xhr-start",r),h){var b=m&&m.resolve();if(!v&&!m){var E=1,O=document.createTextNode(E);new h(a).observe(O,{characterData:!0})}}else f.on("fn-end",function(t){t[0]&&t[0].type===y||a()})},{}],7:[function(t,e,n){function r(t){var e=this.params,n=this.metrics;if(!this.ended){this.ended=!0;for(var r=0;r<d;r++)t.removeEventListener(u[r],this.listener,!1);if(!e.aborted){if(n.duration=a.now()-this.startTime,4===t.readyState){e.status=t.status;var i=o(t,this.lastSize);if(i&&(n.rxSize=i),this.sameOrigin){var s=t.getResponseHeader("X-NewRelic-App-Data");s&&(e.cat=s.split(", ").pop())}}else e.status=0;n.cbTime=this.cbTime,f.emit("xhr-done",[t],t),c("xhr",[e,n,this.startTime])}}}function o(t,e){var n=t.responseType;if("json"===n&&null!==e)return e;var r="arraybuffer"===n||"blob"===n||"json"===n?t.response:t.responseText;return h(r)}function i(t,e){var n=s(e),r=t.params;r.host=n.hostname+":"+n.port,r.pathname=n.pathname,t.sameOrigin=n.sameOrigin}var a=t("loader");if(a.xhrWrappable){var c=t("handle"),s=t(8),f=t("ee"),u=["load","error","abort","timeout"],d=u.length,l=t("id"),p=t(11),h=t(10),m=window.XMLHttpRequest;a.features.xhr=!0,t(6),f.on("new-xhr",function(t){var e=this;e.totalCbs=0,e.called=0,e.cbTime=0,e.end=r,e.ended=!1,e.xhrGuids={},e.lastSize=null,p&&(p>34||p<10)||window.opera||t.addEventListener("progress",function(t){e.lastSize=t.loaded},!1)}),f.on("open-xhr-start",function(t){this.params={method:t[0]},i(this,t[1]),this.metrics={}}),f.on("open-xhr-end",function(t,e){"loader_config"in NREUM&&"xpid"in NREUM.loader_config&&this.sameOrigin&&e.setRequestHeader("X-NewRelic-ID",NREUM.loader_config.xpid)}),f.on("send-xhr-start",function(t,e){var n=this.metrics,r=t[0],o=this;if(n&&r){var i=h(r);i&&(n.txSize=i)}this.startTime=a.now(),this.listener=function(t){try{"abort"===t.type&&(o.params.aborted=!0),("load"!==t.type||o.called===o.totalCbs&&(o.onloadCalled||"function"!=typeof e.onload))&&o.end(e)}catch(n){try{f.emit("internal-error",[n])}catch(r){}}};for(var c=0;c<d;c++)e.addEventListener(u[c],this.listener,!1)}),f.on("xhr-cb-time",function(t,e,n){this.cbTime+=t,e?this.onloadCalled=!0:this.called+=1,this.called!==this.totalCbs||!this.onloadCalled&&"function"==typeof n.onload||this.end(n)}),f.on("xhr-load-added",function(t,e){var n=""+l(t)+!!e;this.xhrGuids&&!this.xhrGuids[n]&&(this.xhrGuids[n]=!0,this.totalCbs+=1)}),f.on("xhr-load-removed",function(t,e){var n=""+l(t)+!!e;this.xhrGuids&&this.xhrGuids[n]&&(delete this.xhrGuids[n],this.totalCbs-=1)}),f.on("addEventListener-end",function(t,e){e instanceof m&&"load"===t[0]&&f.emit("xhr-load-added",[t[1],t[2]],e)}),f.on("removeEventListener-end",function(t,e){e instanceof m&&"load"===t[0]&&f.emit("xhr-load-removed",[t[1],t[2]],e)}),f.on("fn-start",function(t,e,n){e instanceof m&&("onload"===n&&(this.onload=!0),("load"===(t[0]&&t[0].type)||this.onload)&&(this.xhrCbStart=a.now()))}),f.on("fn-end",function(t,e){this.xhrCbStart&&f.emit("xhr-cb-time",[a.now()-this.xhrCbStart,this.onload,e],e)})}},{}],8:[function(t,e,n){e.exports=function(t){var e=document.createElement("a"),n=window.location,r={};e.href=t,r.port=e.port;var o=e.href.split("://");!r.port&&o[1]&&(r.port=o[1].split("/")[0].split("@").pop().split(":")[1]),r.port&&"0"!==r.port||(r.port="https"===o[0]?"443":"80"),r.hostname=e.hostname||n.hostname,r.pathname=e.pathname,r.protocol=o[0],"/"!==r.pathname.charAt(0)&&(r.pathname="/"+r.pathname);var i=!e.protocol||":"===e.protocol||e.protocol===n.protocol,a=e.hostname===document.domain&&e.port===n.port;return r.sameOrigin=i&&(!e.hostname||a),r}},{}],9:[function(t,e,n){function r(){}function o(t,e,n){return function(){return i(t,[f.now()].concat(c(arguments)),e?null:this,n),e?void 0:this}}var i=t("handle"),a=t(12),c=t(13),s=t("ee").get("tracer"),f=t("loader"),u=NREUM;"undefined"==typeof window.newrelic&&(newrelic=u);var d=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],l="api-",p=l+"ixn-";a(d,function(t,e){u[e]=o(l+e,!0,"api")}),u.addPageAction=o(l+"addPageAction",!0),u.setCurrentRouteName=o(l+"routeName",!0),e.exports=newrelic,u.interaction=function(){return(new r).get()};var h=r.prototype={createTracer:function(t,e){var n={},r=this,o="function"==typeof e;return i(p+"tracer",[f.now(),t,n],r),function(){if(s.emit((o?"":"no-")+"fn-start",[f.now(),r,o],n),o)try{return e.apply(this,arguments)}finally{s.emit("fn-end",[f.now()],n)}}}};a("setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(t,e){h[e]=o(p+e)}),newrelic.noticeError=function(t){"string"==typeof t&&(t=new Error(t)),i("err",[t,f.now()])}},{}],10:[function(t,e,n){e.exports=function(t){if("string"==typeof t&&t.length)return t.length;if("object"==typeof t){if("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer&&t.byteLength)return t.byteLength;if("undefined"!=typeof Blob&&t instanceof Blob&&t.size)return t.size;if(!("undefined"!=typeof FormData&&t instanceof FormData))try{return JSON.stringify(t).length}catch(e){return}}}},{}],11:[function(t,e,n){var r=0,o=navigator.userAgent.match(/Firefox[\/\s](\d+\.\d+)/);o&&(r=+o[1]),e.exports=r},{}],12:[function(t,e,n){function r(t,e){var n=[],r="",i=0;for(r in t)o.call(t,r)&&(n[i]=e(r,t[r]),i+=1);return n}var o=Object.prototype.hasOwnProperty;e.exports=r},{}],13:[function(t,e,n){function r(t,e,n){e||(e=0),"undefined"==typeof n&&(n=t?t.length:0);for(var r=-1,o=n-e||0,i=Array(o<0?0:o);++r<o;)i[r]=t[e+r];return i}e.exports=r},{}],14:[function(t,e,n){e.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],15:[function(t,e,n){function r(t){return!(t&&t instanceof Function&&t.apply&&!t[a])}var o=t("ee"),i=t(13),a="nr@original",c=Object.prototype.hasOwnProperty,s=!1;e.exports=function(t,e){function n(t,e,n,o){function nrWrapper(){var r,a,c,s;try{a=this,r=i(arguments),c="function"==typeof n?n(r,a):n||{}}catch(f){l([f,"",[r,a,o],c])}u(e+"start",[r,a,o],c);try{return s=t.apply(a,r)}catch(d){throw u(e+"err",[r,a,d],c),d}finally{u(e+"end",[r,a,s],c)}}return r(t)?t:(e||(e=""),nrWrapper[a]=t,d(t,nrWrapper),nrWrapper)}function f(t,e,o,i){o||(o="");var a,c,s,f="-"===o.charAt(0);for(s=0;s<e.length;s++)c=e[s],a=t[c],r(a)||(t[c]=n(a,f?c+o:o,i,c))}function u(n,r,o){if(!s||e){var i=s;s=!0;try{t.emit(n,r,o,e)}catch(a){l([a,n,r,o])}s=i}}function d(t,e){if(Object.defineProperty&&Object.keys)try{var n=Object.keys(t);return n.forEach(function(n){Object.defineProperty(e,n,{get:function(){return t[n]},set:function(e){return t[n]=e,e}})}),e}catch(r){l([r])}for(var o in t)c.call(t,o)&&(e[o]=t[o]);return e}function l(e){try{t.emit("internal-error",e)}catch(n){}}return t||(t=o),n.inPlace=f,n.flag=a,n}},{}],ee:[function(t,e,n){function r(){}function o(t){function e(t){return t&&t instanceof r?t:t?s(t,c,i):i()}function n(n,r,o,i){if(!l.aborted||i){t&&t(n,r,o);for(var a=e(o),c=h(n),s=c.length,f=0;f<s;f++)c[f].apply(a,r);var d=u[w[n]];return d&&d.push([g,n,r,a]),a}}function p(t,e){y[t]=h(t).concat(e)}function h(t){return y[t]||[]}function m(t){return d[t]=d[t]||o(n)}function v(t,e){f(t,function(t,n){e=e||"feature",w[n]=e,e in u||(u[e]=[])})}var y={},w={},g={on:p,emit:n,get:m,listeners:h,context:e,buffer:v,abort:a,aborted:!1};return g}function i(){return new r}function a(){(u.api||u.feature)&&(l.aborted=!0,u=l.backlog={})}var c="nr@context",s=t("gos"),f=t(12),u={},d={},l=e.exports=o();l.backlog=u},{}],gos:[function(t,e,n){function r(t,e,n){if(o.call(t,e))return t[e];var r=n();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return t[e]=r,r}var o=Object.prototype.hasOwnProperty;e.exports=r},{}],handle:[function(t,e,n){function r(t,e,n,r){o.buffer([t],r),o.emit(t,e,n)}var o=t("ee").get("handle");e.exports=r,r.ee=o},{}],id:[function(t,e,n){function r(t){var e=typeof t;return!t||"object"!==e&&"function"!==e?-1:t===window?0:a(t,i,function(){return o++})}var o=1,i="nr@id",a=t("gos");e.exports=r},{}],loader:[function(t,e,n){function r(){if(!b++){var t=x.info=NREUM.info,e=l.getElementsByTagName("script")[0];if(setTimeout(u.abort,3e4),!(t&&t.licenseKey&&t.applicationID&&e))return u.abort();f(w,function(e,n){t[e]||(t[e]=n)}),s("mark",["onload",a()+x.offset],null,"api");var n=l.createElement("script");n.src="https://"+t.agent,e.parentNode.insertBefore(n,e)}}function o(){"complete"===l.readyState&&i()}function i(){s("mark",["domContent",a()+x.offset],null,"api")}function a(){return E.exists&&performance.now?Math.round(performance.now()):(c=Math.max((new Date).getTime(),c))-x.offset}var c=(new Date).getTime(),s=t("handle"),f=t(12),u=t("ee"),d=window,l=d.document,p="addEventListener",h="attachEvent",m=d.XMLHttpRequest,v=m&&m.prototype;NREUM.o={ST:setTimeout,SI:d.setImmediate,CT:clearTimeout,XHR:m,REQ:d.Request,EV:d.Event,PR:d.Promise,MO:d.MutationObserver};var y=""+location,w={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1059.min.js"},g=m&&v&&v[p]&&!/CriOS/.test(navigator.userAgent),x=e.exports={offset:c,now:a,origin:y,features:{},xhrWrappable:g};t(9),l[p]?(l[p]("DOMContentLoaded",i,!1),d[p]("load",r,!1)):(l[h]("onreadystatechange",o),d[h]("onload",r)),s("mark",["firstbyte",c],null,"api");var b=0,E=t(14)},{}]},{},["loader",2,7]);</script><script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","queueTime":0,"licenseKey":"1beac94c95","agent":"","transactionName":"NQQGYUZWDUNSVUMPWQxOIkBaVBdZXFgYCUYHDwFRTBkAX0FTGQJcAw8DWlVHE0MdVVgIQgcPEEZRRRVVQRhaD1IGDQFCVUUGCmBCVhJfASILW0BSDURgU0UQUxBPFEdbVAZDQGlFA0cXBBdB","atts":"GUMRFw5MQVNcWEMDWBYSAUdCUhEeUFdUDlMDAwhQFg0FUV9FUkoUAQ4KQVFZF0NWREEDREwCC1tAUg1EbFpSCBRYUFUCAwdPElBZWRJTDBUXUEZBBkIdRlYSXkBbRlQHaFEAAgBAVBgKFQlZFhtBU1xYQwNYFhIBR0JSER5QWVkSUwwVO0FNRwYSCRRDA04WTgxBWVtBHBFVWAhCBw8QRlFFFVVBGFEUWQ8+B1FaFVlWUlpEAxpAAgtARkQGb1pSFVwUAQ4RR0dSTkYCDGIkdUkiNGZ3BFIHHgQHVx1QUVUDYwVBHBFZRQEUWEMxd3cVTxJQWVkSUwwVF1BGQQZCHVpYBV0HBUYPQEUWVU5L","applicationID":"3415687","errorBeacon":"bam.nr-data.net","applicationTime":22}</script>
    <title>CS 317 Assignment 3</title>
  </head>

  <body>
    <h1>A Simple FTP server</h1>

    <div class="due">
      <h2>Due Date</h2>
      Monday April 3, 11:59 PM.<br>
      Late penalty: 5% per day (pro-rated by the minute) to a maximum of 2
      days. Assignments are not accepted after 2 days.<br>
      Although you may do this assignment alone, you are strongly encouraged to work with a partner. To encourage you to do that a bonus will be given for
      people working with a partner.
      The educational research shows that students who program with a partner learn the material better.
      </div>

<h2>Revision notes</h2>
<ul>
  <li> None yet.
</ul>


    <div class="goals">
      <h2>Goals</h2>
      <ul>
     <li>To learn how to program with TCP sockets in C
        <li>To learn how to read and implement a well-specified
         protocol.</li>
    <li>To develop your programming and debugging skills as they relate to 
        the use of sockets in C</li>
	<li>To implement the server side of the FTP protocol</li>
	<li>To develop general networking experimental skills</li>
	<li>To develop a further understanding of what TCP does, and how
          to manage multiple TCP connections from the server perspective.</li>
      </ul>
    </div>

  <div class="Requirements">
    <h2>Basic Assignment Requirements</h2>

    <ul>
      <li>For consistency across the assignments, this program must
      be written in C. (C++ is not acceptable)</li>

      <li>The program must include a working makefile that will
      compile and link the application.</li>

      <li><b>The program must run on the Undergraduate Linux
      machines</b> maintained by the department.</li>

      <li>If the program does not compile and link to produce an
      executable file, a mark of 0 (zero) will be awarded. (Note,
      this is not the same as saying the program has to work.)
      Consequently it is important to implement this assignment
      incrementally by slowly building on pieces of code that you
      already have working. <b>DO NOT TRY TO WRITE THE ASSIGNMENT
      ALL AT ONCE!</b></li>

     <li>Your program must compile and link without any warnings. You are 
    not permitted to use any command line options or compiler directives to 
       suppress warnings.
     <li>The version of your assignment that will be marked is the
     <b>master branch.</b>
    </ul>
  </div>





<h2>Special Note</h2> All assignments in this course must compile and
run on the Linux undergrad servers provided for student use. If you
use a different environment be sure to check that your solution works
on the ugrad machines as you will be graded on how it works on the
department machines not on your own machine. All instructions for
accessing code, building programs, using source code control tools
etc, assume you are working on these machines. If you are working in a
different environment commands and parameters may be different. Given
the diverse collection of machines it is not possible for us to
provide instruction and guidance on how to use these tools or their
analogues across these varied environments.  <B>Pleas for leniency or
special consideration of the nature "But it works on my laptop under
...." will not be entertained,</b> so make sure it works on the
undergraduate Linux servers and allow time for testing in that environment so
that you are confident your code works as expected there. 
<p>The above warning is especially true when working with C on different 
operating systems. The precise system calls and their behaviour can 
differ significantly between different operating systems so just because it 
compiles and runs on your own machine, especially if it is a MAC, do not 
expect it to simply run and work on the department Linux machines.


    <h2>Assignment Overview</h2>

    <p>
    In this assignment you will use the Unix Socket API to construct
    a minimal ftp server, called CSftp,  capable of interacting with a variety of 
    ftp clients. 
    <p>Your program is to take a single argument, the TCP the port
    your ftp server is to listen on for ftp client connections. 

  <p>Once completed the program will, roughly, do the
  following:</p>

  <ol>
    <li>Listens for connections</li>

    <li>Accepts a connection from the client.</li>

    <li>Responds with a 220 to initiate a login sequence. The only user name that the program is to accept is cs317 and no password is required.
    <li>Once logged in the server will accept certain ftp commands until the 
     connection is closed by the client, or the quit command is sent. 
   <li>When the connection is closed the server will go back to waiting 
    for a new connection.
   <li>Your server only has to handle one client at at time.

</ol>

<h2>What to implement</h2>

The server is to implement the server part of the ftp protocol as specified in 
<a href="https://www.ietf.org/rfc/rfc959.txt">RFC 959</a>. Section 5.1
outlines the minimum requirement for an ftp server but we are going 
to strip down that a bit  more and add a couple of commands. The commands
from the client to the server you are to support are (relevant RFC sections are in parenthesis):

<ul>
<li>USER - (4.1.1)
<li>QUIT - (4.1.1)
<li>CWD  - (4.1.1) For security reasons you are not accept any CWD command
  that starts with ./ or ../ or contains ../ in it. (hint see the chdir system call.)
<li>CDUP - (4.1.1) For security reasons do not allow a CDUP command to 
    set the working directory to be the parent directory of where 
    your ftp server is started from. (hint use the getcwd system call to 
    get the initial working directory so that you know where things are 
    started from and then if a CDUP command is received while in that 
    diredtory return an appropriate error code to the client.)
<li>TYPE - (4.1.1) you are only to support the Image and ASCII type (3.1.1, 3.1.1.3)
<li>MODE - you are only to support Stream mode (3.4.1)
<li>STRU - you are only to support File structure type (3.1.2, 3.1.2.1)
<li>RETR - (4.1.3)
<li>PASV - (4.1.1)
<li>NLST - (4.1.3)  to produce a directory listing, you are only
     required to support the version of NLST with no command parameters. Respond with a 501 if the server gets an NLST with a parameter.

</ul>
<p>For any command that your server does not support respond with a reply code of 500. 
    
    <p>
    Your program will implement a scaled back ftp server. Since it is a server
    the functionality of your implementation will be judged on 
    how it interacts with real ftp clients.  


    <h2>Implementation Constraints and Suggestions</h2>

    <p>
    Don't try to implement this assignment all at once. Instead
    incrementally build and simultaneously test the solution. A
    suggested strategy is to:
    
    <ul>
      <li>Check your assignment 1 and make sure you understand the
	commands that a client is going to send. (Don't confuse the commands
	typed to the user interface with those sent from the client to the
	server.)
      <li>Have your program create a socket using the port number specified on the command line and and start listening on that port. 
      <li>Have your server accept a connection and respond appropriately
      <li>Get your server to start reading and parsing the commands. You might
        find the Unix library routines <em>strncmp()</em>, <em>toupper()</em>,
	or the whole set of regex routines helpful. At this point just respond with a 500.
      <li>Work on handling the simple commands first.
      <li>Implement support for PASV
      <li>Implement NLST - the file dir.c provides the code you <b>must</b> use to produce the directory listening. 
      <li>Implement RETR
    </ul>

    <p>For the TYPE I and TYPE A commands, always respond with a 200. There is no need for
      your code to do anything special. That is, from your program's perspective
     these two commands are identical and don't require any changes in how 
your program responds to, or treats, data.

    <p>
      For testing purposes you can use telnet, nc, or any FTP client you want. You
      are strongly urged to try multiple clients with your server. Also, make sure it handles
      commands in mixed case.

    <p>Do not rely only upon telnet and nc for your testing. We will test using
       the linux ftp client. At a bare minimum your client must interact
       with this client. Under no circumstances will we test with 
       nc or telnet. You will only recieve marks for the parts of 
       your server that interact properly with the ftp client.

    <p>Your program only has to be able to provide a directory listing and transfer files in the directory the server is run from. 


    <p>
    You may discuss this assignment with your classmates, but you must
    do your work only with your  partner. You are not allowed to
    show your code, even for discussion or explanatory purposes to
    other classmates.
    
    <p>
    Your code is to be developed for the Undergrad Linux server machines
    (e.g., remote.ugrad.cs.ubc.ca). The TAs will test your code on these machines, so
    test your program extensively in this environment, <em>including
    your Makefile</em>.
    
    <p>
    Style and comments are part of the evaluation, so keep your code
    clear, clean and well-documented. Your code should be easy to
    read, with blank lines delineating blocks of functionality, and
    avoiding long lines. Use proper comments and  names
    for variables and fucntions that accurately reflect their purpose. Use functions to deal with long
    blocks of code and repeated functionality. It is OK to add new .h and .c files, just don't break the
    makefile.
    
    
    <h2>What to Hand In</h2>

    <p>
     You are to use git to handin all materials for this assignment. The last
     push of your repo is what will be marked. Any late penalty will be
     computed based on the time of your last push.  Any commits pushed after
     the
48-hour deadline for late submissions will be ignored.
    
    <p>
    Make sure your git repository on the department stash server has the following files: 
    <ul>
      <li>A <em>README.txt</em> file that contains any information you would 
      like to convey to the TAs about your assignment. For example maybe you
      didn't get some part of the assignment working, or it works in some 
      circumstances but not others. If you have no comments you can leave the 
      file empty or remove it from your repository. The contents of the file
        must
      be plain text ASCII that is easily viewable using more on the ugrad Linux
        machines. As such limit your lines to 90 characters. If you are using Windows
        make sure that the the format makes sense on the Linux machines. 

      <li>All of the C files required to build your version of  CSftp. Don't forget to use the git add command to include any new or update files to the list of files to commit and then push.  
      <li>A Makefile such that when the TA types <tt>make</tt> a
      executable file named <tt>CSftp</tt> is built. The executable   must end
      up in the same directory as the Makefile is (i.e., the home
      directory of your assignment). Note, this does not have to be a
      complicated Makefile and it is acceptable for the Makefile to
      always rebuild the program regardless of whether or not they are
      out-of-date with respect to their source files. We have supplied you with a Makefile that should provide this basic functionality. 
    </ul>

  </body>
</html>
